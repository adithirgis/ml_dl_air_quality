---
title: "DL"
author: "Adithi R Upadhya"
date: "03/12/2021"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## dl_grid

```{r eval = FALSE}
H2O Grid Details
================

Grid ID: dl_grid 
Used hyper parameters: 
  -  activation 
  -  distribution 
  -  epochs 
  -  epsilon 
  -  hidden 
  -  input_dropout_ratio 
  -  l1 
  -  l2 
  -  max_w2 
  -  momentum_stable 
  -  momentum_start 
  -  rate 
  -  rate_annealing 
  -  rho 
Number of models: 83 
Number of failed models: 0 

Hyper-Parameter Search Summary: ordered by increasing residual_deviance
         activation distribution    epochs epsilon               hidden input_dropout_ratio      l1
1         Rectifier      poisson 107.08551 0.00000     [50, 50, 50, 50]             0.10000 0.00000
2              Tanh      poisson  53.98138 0.00000      [5, 5, 5, 5, 5]             0.20000 0.00010
3   TanhWithDropout      poisson  53.98138 0.00010     [30, 30, 30, 30]             0.00000 0.00000
4 MaxoutWithDropout      poisson 305.09408 0.00000 [100, 100, 100, 100]             0.10000 0.00010
5         Rectifier        gamma 504.85290 0.00000     [30, 30, 30, 30]             0.00000 0.00001
       l2                                        max_w2 momentum_stable momentum_start    rate
1 0.00010                                       1.00000         0.99000        0.00000 0.00000
2 0.00010 340282349999999991754788743781432688640.00000         0.50000        0.50000 0.00100
3 0.00000 340282349999999991754788743781432688640.00000         0.50000        0.50000 0.00000
4 0.00000                                     100.00000         0.99000        0.00000 0.00000
5 0.00000 340282349999999991754788743781432688640.00000         0.00000        0.00000 0.00500
  rate_annealing     rho        model_ids residual_deviance
1        0.00000 0.95000  dl_grid_model_5        -925.65099
2        0.00000 0.99000  dl_grid_model_4        -925.16723
3        0.00000 0.99000  dl_grid_model_9        -902.56549
4        0.00000 0.95000 dl_grid_model_11        -614.98345
5        0.00000 0.90000 dl_grid_model_38          11.24109

---
          activation distribution    epochs epsilon               hidden input_dropout_ratio      l1
78              Tanh     gaussian 107.08551 0.00010 [100, 100, 100, 100]             0.10000 0.00000
79   TanhWithDropout     gaussian 400.47305 0.00010     [50, 50, 50, 50]             0.10000 0.00010
80              Tanh     gaussian  17.97134 0.00010 [100, 100, 100, 100]             0.00000 0.00001
81              Tanh     gaussian 107.08551 0.00000     [50, 50, 50, 50]             0.00000 0.00000
82   TanhWithDropout     gaussian 404.08167 0.00010     [50, 50, 50, 50]             0.10000 0.00010
83 MaxoutWithDropout     gaussian 107.08551 0.00010 [100, 100, 100, 100]             0.10000 0.00000
        l2    max_w2 momentum_stable momentum_start    rate rate_annealing     rho        model_ids
78 0.00010  10.00000         0.99000        0.00000 0.00500        0.00000 0.95000 dl_grid_model_76
79 0.00000  10.00000         0.00000        0.00000 0.00000        0.00000 0.99900 dl_grid_model_74
80 0.00010 100.00000         0.00000        0.50000 0.00100        0.00000 0.90000 dl_grid_model_81
81 0.00010 100.00000         0.00000        0.50000 0.00000        0.00000 0.99900 dl_grid_model_71
82 0.00000 100.00000         0.00000        0.00000 0.00000        0.00000 0.99900 dl_grid_model_34
83 0.00010 100.00000         0.99000        0.00000 0.00500        0.00000 0.95000 dl_grid_model_36
   residual_deviance
78        7363.19860
79       14188.95395
80       21872.50333
81       83802.40223
82      402384.53789
83     7922589.34173
```

## print(grid_perf)

```{r eval = FALSE}
 H2O Grid Details
================

Grid ID: dl_grid 
Used hyper parameters: 
  -  activation 
  -  distribution 
  -  epochs 
  -  epsilon 
  -  hidden 
  -  input_dropout_ratio 
  -  l1 
  -  l2 
  -  max_w2 
  -  momentum_stable 
  -  momentum_start 
  -  rate 
  -  rate_annealing 
  -  rho 
Number of models: 83 
Number of failed models: 0 

Hyper-Parameter Search Summary: ordered by increasing mse
  activation distribution    epochs epsilon           hidden input_dropout_ratio      l1      l2
1  Rectifier     gaussian 305.09408 0.00000 [50, 50, 50, 50]             0.10000 0.00000 0.00001
2  Rectifier        gamma 504.85290 0.00000 [30, 30, 30, 30]             0.00000 0.00001 0.00000
3       Tanh     gaussian 504.85290 0.00000  [5, 5, 5, 5, 5]             0.20000 0.00010 0.00010
4  Rectifier     gaussian 404.08167 0.00000 [30, 30, 30, 30]             0.20000 0.00010 0.00010
5  Rectifier        gamma 504.85290 0.00000  [5, 5, 5, 5, 5]             0.20000 0.00001 0.00001
                                         max_w2 momentum_stable momentum_start    rate
1 340282349999999991754788743781432688640.00000         0.50000        0.50000 0.00500
2 340282349999999991754788743781432688640.00000         0.00000        0.00000 0.00500
3 340282349999999991754788743781432688640.00000         0.00000        0.00000 0.00500
4                                    1000.00000         0.99000        0.00000 0.00000
5                                     100.00000         0.50000        0.50000 0.00100
  rate_annealing     rho        model_ids       mse
1        0.00000 0.95000 dl_grid_model_18 725.57676
2        0.00000 0.90000 dl_grid_model_38 790.13705
3        0.00000 0.90000 dl_grid_model_19 792.44309
4        0.00000 0.99900 dl_grid_model_30 820.41788
5        0.00000 0.95000 dl_grid_model_29 824.25674

---
          activation distribution    epochs epsilon               hidden input_dropout_ratio      l1
78 MaxoutWithDropout      poisson 305.09408 0.00000 [100, 100, 100, 100]             0.10000 0.00010
79              Tanh     gaussian  17.97134 0.00010 [100, 100, 100, 100]             0.00000 0.00001
80              Tanh     gaussian 107.08551 0.00000     [50, 50, 50, 50]             0.00000 0.00000
81   TanhWithDropout     gaussian 404.08167 0.00010     [50, 50, 50, 50]             0.10000 0.00010
82 MaxoutWithDropout     gaussian 107.08551 0.00010 [100, 100, 100, 100]             0.10000 0.00000
83   TanhWithDropout        gamma  53.98138 0.00000      [5, 5, 5, 5, 5]             0.00000 0.00010
        l2    max_w2 momentum_stable momentum_start    rate rate_annealing     rho        model_ids
78 0.00000 100.00000         0.99000        0.00000 0.00000        0.00000 0.95000 dl_grid_model_11
79 0.00010 100.00000         0.00000        0.50000 0.00100        0.00000 0.90000 dl_grid_model_81
80 0.00010 100.00000         0.00000        0.50000 0.00000        0.00000 0.99900 dl_grid_model_71
81 0.00000 100.00000         0.00000        0.00000 0.00000        0.00000 0.99900 dl_grid_model_34
82 0.00010 100.00000         0.99000        0.00000 0.00500        0.00000 0.95000 dl_grid_model_36
83 0.00000  10.00000         0.99000        0.00000 0.00100        0.00000 0.99000 dl_grid_model_77
                              mse
78                    15714.08099
79                    21872.50333
80                    83802.40223
81                   402384.53789
82                  7922589.34173
83 126183013924360004042752.00000
```


## best_model

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 244.3 KB, 1,213,960 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.042195 0.192355 0.000000    0.000962   0.107278
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.005414 0.005663 0.000000   -0.024584   0.211814
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.006003 0.007136 0.000000   -0.030739   0.195136
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.008118 0.023343 0.000000   -0.037190   0.173567
6     6     1    Linear      NA 0.000000 0.000010  0.001181 0.001077 0.000000   -0.003162   0.182863
  mean_bias bias_rms
1        NA       NA
2  0.383706 0.235384
3  0.938939 0.096356
4  0.928688 0.110840
5  0.847727 0.184105
6  0.736737 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  379.7752
RMSE:  19.48782
MAE:  14.11279
RMSLE:  0.1742339
Mean Residual Deviance :  379.7752



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 10-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  725.5768
RMSE:  26.93653
MAE:  19.13027
RMSLE:  0.2228119
Mean Residual Deviance :  725.5768


Cross-Validation Metrics Summary: 
                             mean         sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid
mae                     19.153385   1.410158  20.902502  17.144830  19.592735  21.254229  17.923014
mean_residual_deviance 727.071170 121.405876 821.613900 622.110800 786.262100 980.429700 605.997440
mse                    727.071170 121.405876 821.613900 622.110800 786.262100 980.429700 605.997440
r2                       0.874464   0.024989   0.835399   0.894481   0.854752   0.843008   0.905276
residual_deviance      727.071170 121.405876 821.613900 622.110800 786.262100 980.429700 605.997440
rmse                    26.884064   2.190443  28.663809  24.942148  28.040365  31.311813  24.617016
rmsle                    0.223019   0.011507   0.243607   0.213371   0.218698   0.225969   0.213558
                       cv_6_valid cv_7_valid cv_8_valid cv_9_valid cv_10_valid
mae                     18.850030  17.318794  18.890387  19.479460   20.177876
mean_residual_deviance 685.585900 639.490700 676.588870 630.384950  822.247130
mse                    685.585900 639.490700 676.588870 630.384950  822.247130
r2                       0.895939   0.893413   0.880627   0.886395    0.855356
residual_deviance      685.585900 639.490700 676.588870 630.384950  822.247130
rmse                    26.183695  25.288155  26.011322  25.107468   28.674852
rmsle                    0.205175   0.235962   0.222590   0.220241    0.231020
```


## h2o.varimp(best_model)

```{r eval = FALSE}
Variable Importances: 
  variable relative_importance scaled_importance percentage
1  day.277            1.000000          1.000000   0.007061
2  day.278            0.994366          0.994366   0.007021
3      lat            0.991453          0.991453   0.007000
4   day.54            0.965155          0.965155   0.006815
5  day.333            0.930650          0.930650   0.006571

---
              variable relative_importance scaled_importance percentage
240            day.172            0.383457          0.383457   0.002707
241            day.120            0.373975          0.373975   0.002640
242               Temp            0.350276          0.350276   0.002473
243                BLH            0.324953          0.324953   0.002294
244    day.missing(NA)            0.000000          0.000000   0.000000
245 season.missing(NA)            0.000000          0.000000   0.000000
```


## h2o.scoreHistory(best_model)


```{r eval = FALSE}
Scoring History: 
            timestamp          duration training_speed    epochs iterations        samples
1 2022-03-12 16:45:27         0.000 sec             NA   0.00000          0       0.000000
2 2022-03-12 16:45:28 26 min 31.821 sec  35992 obs/sec  10.00000          1   39160.000000
3 2022-03-12 16:45:34 26 min 37.576 sec  45874 obs/sec  80.00000          8  313280.000000
4 2022-03-12 16:45:39 26 min 42.636 sec  49473 obs/sec 150.00000         15  587400.000000
5 2022-03-12 16:45:45 26 min 48.228 sec  51608 obs/sec 230.00000         23  900680.000000
6 2022-03-12 16:45:50 26 min 53.724 sec  52932 obs/sec 310.00000         31 1213960.000000
  training_rmse training_deviance training_mae training_r2
1            NA                NA           NA          NA
2      32.96518        1086.70336     22.92757     0.81452
3      24.48511         599.52071     16.88979     0.89767
4      23.80091         566.48332     16.74367     0.90331
5      19.80574         392.26750     14.01363     0.93305
6      19.48782         379.77516     14.11279     0.93518
```


## cv_models

```{r eval = FALSE}
[[1]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_1 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,093,369 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.046962 0.200757 0.000000    0.000581   0.094730
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.008741 0.008541 0.000000   -0.019648   0.170555
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.010977 0.013824 0.000000   -0.027018   0.157472
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.038610 0.088583 0.000000   -0.024950   0.151600
6     6     1    Linear      NA 0.000000 0.000010  0.001732 0.001633 0.000000    0.024417   0.148820
  mean_bias bias_rms
1        NA       NA
2  0.353553 0.168757
3  0.936309 0.068094
4  0.966330 0.047215
5  0.893395 0.105394
6  0.046838 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  683.6483
RMSE:  26.14667
MAE:  19.09949
RMSLE:  0.2271887
Mean Residual Deviance :  683.6483


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  821.6139
RMSE:  28.66381
MAE:  20.9025
RMSLE:  0.2436074
Mean Residual Deviance :  821.6139




[[2]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_2 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,053,327 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.050801 0.207416 0.000000    0.001712   0.106557
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.005627 0.005583 0.000000   -0.026638   0.208060
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.005660 0.006311 0.000000   -0.031677   0.189685
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.028426 0.080772 0.000000   -0.032389   0.166942
6     6     1    Linear      NA 0.000000 0.000010  0.001493 0.001407 0.000000   -0.007365   0.181468
  mean_bias bias_rms
1        NA       NA
2  0.291399 0.235786
3  0.870260 0.123315
4  0.931528 0.094880
5  0.841994 0.164246
6  0.368145 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  380.2197
RMSE:  19.49922
MAE:  13.6047
RMSLE:  0.1710282
Mean Residual Deviance :  380.2197


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  622.1108
RMSE:  24.94215
MAE:  17.14483
RMSLE:  0.2133706
Mean Residual Deviance :  622.1108




[[3]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_3 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,067,773 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.043436 0.192488 0.000000    0.003446   0.106185
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.006677 0.006442 0.000000   -0.017850   0.207484
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.006087 0.010396 0.000000   -0.026936   0.184657
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.027523 0.074189 0.000000   -0.029517   0.164144
6     6     1    Linear      NA 0.000000 0.000010  0.000884 0.000771 0.000000    0.017264   0.156735
  mean_bias bias_rms
1        NA       NA
2  0.349571 0.256285
3  0.927588 0.124107
4  0.948155 0.068247
5  0.841597 0.197300
6  0.373148 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  545.3929
RMSE:  23.35365
MAE:  15.93812
RMSLE:  0.1821323
Mean Residual Deviance :  545.3929


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  786.2621
RMSE:  28.04037
MAE:  19.59274
RMSLE:  0.2186978
Mean Residual Deviance :  786.2621




[[4]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_4 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,074,612 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.054909 0.215346 0.000000    0.000366   0.094444
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.009067 0.008895 0.000000   -0.023913   0.168417
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.012239 0.030568 0.000000   -0.029798   0.156840
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.046622 0.107961 0.000000   -0.026787   0.149693
6     6     1    Linear      NA 0.000000 0.000010  0.001581 0.001665 0.000000    0.039446   0.145885
  mean_bias bias_rms
1        NA       NA
2  0.358685 0.139344
3  0.934456 0.059042
4  0.955678 0.045338
5  0.894022 0.098057
6  0.060465 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  690.6777
RMSE:  26.28075
MAE:  18.75309
RMSLE:  0.2156277
Mean Residual Deviance :  690.6777


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  980.4297
RMSE:  31.31181
MAE:  21.25423
RMSLE:  0.2259688
Mean Residual Deviance :  980.4297




[[5]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_5 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,091,317 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.043469 0.193030 0.000000    0.000747   0.106931
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.006224 0.006213 0.000000   -0.024116   0.205427
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.007391 0.008206 0.000000   -0.021944   0.192259
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.027486 0.088680 0.000000   -0.026712   0.165350
6     6     1    Linear      NA 0.000000 0.000010  0.001592 0.001584 0.000000    0.019340   0.184941
  mean_bias bias_rms
1        NA       NA
2  0.342360 0.226894
3  0.896833 0.105930
4  0.954839 0.095620
5  0.889952 0.123389
6  0.370643 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  513.4629
RMSE:  22.65972
MAE:  16.32935
RMSLE:  0.1916295
Mean Residual Deviance :  513.4629


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  605.9974
RMSE:  24.61702
MAE:  17.92301
RMSLE:  0.2135575
Mean Residual Deviance :  605.9974




[[6]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_6 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,059,916 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.043306 0.192737 0.000000    0.001061   0.100111
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.007654 0.006719 0.000000   -0.023325   0.187661
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.009448 0.012998 0.000000   -0.021002   0.177764
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.031259 0.078467 0.000000   -0.030074   0.159444
6     6     1    Linear      NA 0.000000 0.000010  0.001542 0.001679 0.000000    0.027751   0.148806
  mean_bias bias_rms
1        NA       NA
2  0.357066 0.214753
3  0.924045 0.074977
4  0.959970 0.082186
5  0.883826 0.138554
6  0.228137 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  510.97
RMSE:  22.60465
MAE:  15.69231
RMSLE:  0.1867113
Mean Residual Deviance :  510.97


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  685.5859
RMSE:  26.1837
MAE:  18.85003
RMSLE:  0.2051755
Mean Residual Deviance :  685.5859




[[7]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_7 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,088,206 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.050751 0.207583 0.000000    0.001199   0.098840
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.009318 0.013788 0.000000   -0.028398   0.186459
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.011254 0.014124 0.000000   -0.029943   0.174356
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.031759 0.071174 0.000000   -0.032406   0.156022
6     6     1    Linear      NA 0.000000 0.000010  0.001810 0.001796 0.000000    0.028726   0.154639
  mean_bias bias_rms
1        NA       NA
2  0.307199 0.195510
3  0.894441 0.085891
4  0.941826 0.073889
5  0.878834 0.114183
6  0.264607 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  560.5826
RMSE:  23.67663
MAE:  16.74513
RMSLE:  0.1946613
Mean Residual Deviance :  560.5826


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  639.4907
RMSE:  25.28815
MAE:  17.31879
RMSLE:  0.2359622
Mean Residual Deviance :  639.4907




[[8]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_8 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,085,824 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.042886 0.192461 0.000000    0.002978   0.107974
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.003966 0.004061 0.000000   -0.022165   0.203998
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.006481 0.008395 0.000000   -0.029368   0.190795
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.020102 0.068703 0.000000   -0.029594   0.167947
6     6     1    Linear      NA 0.000000 0.000010  0.001059 0.001149 0.000000    0.017804   0.168141
  mean_bias bias_rms
1        NA       NA
2  0.368273 0.240750
3  0.922307 0.124431
4  0.950919 0.084918
5  0.865720 0.172028
6  0.369929 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  542.0662
RMSE:  23.28232
MAE:  16.66959
RMSLE:  0.2003943
Mean Residual Deviance :  542.0662


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  676.5889
RMSE:  26.01132
MAE:  18.89039
RMSLE:  0.2225902
Mean Residual Deviance :  676.5889




[[9]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_9 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,069,120 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.047304 0.200732 0.000000    0.001201   0.099261
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.008511 0.008444 0.000000   -0.022409   0.189819
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.008087 0.008745 0.000000   -0.027515   0.171132
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.026895 0.066516 0.000000   -0.029347   0.156641
6     6     1    Linear      NA 0.000000 0.000010  0.001454 0.001252 0.000000    0.026674   0.148664
  mean_bias bias_rms
1        NA       NA
2  0.306963 0.197566
3  0.908686 0.108602
4  0.952076 0.061953
5  0.890402 0.142651
6  0.280040 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  625.4271
RMSE:  25.00854
MAE:  18.51835
RMSLE:  0.2156437
Mean Residual Deviance :  625.4271


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  630.3849
RMSE:  25.10747
MAE:  19.47946
RMSLE:  0.2202408
Mean Residual Deviance :  630.3849




[[10]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_18_cv_10 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 245.3 KB, 1,069,458 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.044114 0.193864 0.000000    0.001380   0.106250
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.007652 0.005849 0.000000   -0.021134   0.207599
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.007546 0.007731 0.000000   -0.030481   0.188660
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.017932 0.038202 0.000000   -0.032150   0.166874
6     6     1    Linear      NA 0.000000 0.000010  0.001025 0.000710 0.000000    0.010155   0.171917
  mean_bias bias_rms
1        NA       NA
2  0.352734 0.220188
3  0.918976 0.115806
4  0.945062 0.079996
5  0.875140 0.196530
6  0.404826 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  493.5551
RMSE:  22.2161
MAE:  15.74575
RMSLE:  0.1944853
Mean Residual Deviance :  493.5551


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  822.2471
RMSE:  28.67485
MAE:  20.17788
RMSLE:  0.2310204
Mean Residual Deviance :  822.2471

```

## best_model_perf


```{r eval = FALSE}
H2ORegressionMetrics: deeplearning

MSE:  681.1223
RMSE:  26.09832
MAE:  18.5167
RMSLE:  0.2152902
Mean Residual Deviance :  681.1223
```

## h2o.mse(best_model_perf) %>% sqrt()

```{r eval = FALSE}
26.09832
```


## model_dl

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  DeepLearning_model_R_1647001632925_11 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 244.8 KB, 206,349 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.030223 0.102838 0.000000    0.001588   0.109895
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.027019 0.021004 0.000000   -0.034106   0.215922
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.051104 0.071816 0.000000   -0.048248   0.185121
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.119238 0.164861 0.000000   -0.044644   0.150490
6     6     1    Linear      NA 0.000000 0.000010  0.003318 0.002362 0.000000    0.025220   0.100696
  mean_bias bias_rms
1        NA       NA
2  0.254893 0.251529
3  0.892186 0.158582
4  0.928080 0.114269
5  0.812169 0.202992
6  0.493598 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  459.1528
RMSE:  21.42785
MAE:  15.07051
RMSLE:  0.1819904
Mean Residual Deviance :  459.1528
```


## model_dl_10

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  DeepLearning_model_R_1647001632925_12 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 244.8 KB, 111,540 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.028279 0.102913 0.000000    0.001066   0.102220
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.032982 0.029134 0.000000   -0.035798   0.194811
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.054055 0.063707 0.000000   -0.044436   0.170151
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.134715 0.195859 0.000000   -0.039766   0.147480
6     6     1    Linear      NA 0.000000 0.000010  0.004560 0.004088 0.000000    0.023197   0.102169
  mean_bias bias_rms
1        NA       NA
2  0.286420 0.211567
3  0.887598 0.109725
4  0.917162 0.077425
5  0.828799 0.173623
6  0.391521 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  638.045
RMSE:  25.25955
MAE:  18.01713
RMSLE:  0.2122756
Mean Residual Deviance :  638.045



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 10-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  665.0879
RMSE:  25.7893
MAE:  17.64706
RMSLE:  0.2035253
Mean Residual Deviance :  665.0879


Cross-Validation Metrics Summary: 
                             mean        sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid
mae                     17.638584  0.676270  18.037766  17.112715  17.841550  18.399070  16.875074
mean_residual_deviance 663.824460 59.618385 697.261300 602.770750 754.668200 681.704400 641.352360
mse                    663.824460 59.618385 697.261300 602.770750 754.668200 681.704400 641.352360
r2                       0.888243  0.012415   0.881815   0.910217   0.876386   0.891540   0.884548
residual_deviance      663.824460 59.618385 697.261300 602.770750 754.668200 681.704400 641.352360
rmse                    25.741081  1.164858  26.405706  24.551390  27.471226  26.109470  25.324934
rmsle                    0.203107  0.009024   0.210043   0.196503   0.210370   0.202577   0.202529
                       cv_6_valid cv_7_valid cv_8_valid cv_9_valid cv_10_valid
mae                     18.073795  16.673344  16.910643  17.981007   18.480879
mean_residual_deviance 732.403260 558.712200 618.665900 677.540650  673.165470
mse                    732.403260 558.712200 618.665900 677.540650  673.165470
r2                       0.870082   0.902649   0.890521   0.878568    0.896107
residual_deviance      732.403260 558.712200 618.665900 677.540650  673.165470
rmse                    27.062950  23.637094  24.872995  26.029612   25.945433
rmsle                    0.218936   0.197781   0.185582   0.204270    0.202478
```

## model_dl_sp

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  DeepLearning_model_R_1647001632925_13 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 244.9 KB, 94,809 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.028094 0.103384 0.000000    0.000857   0.100493
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.034338 0.026459 0.000000   -0.034883   0.190619
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.051010 0.054468 0.000000   -0.041520   0.167541
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.140003 0.200245 0.000000   -0.038334   0.147243
6     6     1    Linear      NA 0.000000 0.000010  0.004597 0.003991 0.000000    0.023102   0.103035
  mean_bias bias_rms
1        NA       NA
2  0.275496 0.199066
3  0.896309 0.101567
4  0.921083 0.067626
5  0.828787 0.162608
6  0.362589 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  662.7728
RMSE:  25.74437
MAE:  16.92716
RMSLE:  0.190451
Mean Residual Deviance :  662.7728



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 38-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  580.1089
RMSE:  24.08545
MAE:  16.32369
RMSLE:  0.2002988
Mean Residual Deviance :  580.1089


Cross-Validation Metrics Summary: 
                             mean         sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid
mae                     16.283490   5.012451  13.012255  18.003120  11.419966  17.038557  18.037260
mean_residual_deviance 576.134500 335.488000 311.778930 642.612400 265.205300 608.456050 955.714100
mse                    576.134500 335.488000 311.778930 642.612400 265.205300 608.456050 955.714100
r2                       0.886943   0.095521   0.941376   0.916996   0.963785   0.843658   0.864727
residual_deviance      576.134500 335.488000 311.778930 642.612400 265.205300 608.456050 955.714100
rmse                    23.097538   6.617448  17.657263  25.349800  16.285124  24.666900  30.914627
rmsle                    0.190458   0.058221   0.166727   0.174331   0.135081   0.265552   0.168034
                       cv_6_valid cv_7_valid cv_8_valid cv_9_valid cv_10_valid cv_11_valid
mae                     13.067302  16.553295  12.315071  11.033097   18.531830   15.893987
mean_residual_deviance 296.918400 490.897980 351.866150 271.061770  757.695740  857.788400
mse                    296.918400 490.897980 351.866150 271.061770  757.695740  857.788400
r2                       0.938431   0.912167   0.937567   0.950829    0.879184    0.831073
residual_deviance      296.918400 490.897980 351.866150 271.061770  757.695740  857.788400
rmse                    17.231321  22.156218  18.758097  16.463955   27.526274   29.288025
rmsle                    0.138303   0.217553   0.132276   0.127735    0.223645    0.255311
                       cv_12_valid cv_13_valid cv_14_valid cv_15_valid cv_16_valid cv_17_valid
mae                      25.990185   11.339394   14.790206   10.086247   20.571518   12.181074
mean_residual_deviance 1174.052200  269.123900  443.633240  182.848830  794.942400  316.406830
mse                    1174.052200  269.123900  443.633240  182.848830  794.942400  316.406830
r2                        0.705417    0.955450    0.928942    0.973980    0.778415    0.932754
residual_deviance      1174.052200  269.123900  443.633240  182.848830  794.942400  316.406830
rmse                     34.264446   16.404997   21.062603   13.522161   28.194723   17.787828
rmsle                     0.296839    0.121246    0.149343    0.137668    0.261774    0.155756
                       cv_18_valid cv_19_valid cv_20_valid cv_21_valid cv_22_valid cv_23_valid
mae                      11.300218   20.258432   18.362970   18.208158   20.212946   20.778208
mean_residual_deviance  224.366680  899.694600  611.253970  836.877260  745.481900  928.847170
mse                     224.366680  899.694600  611.253970  836.877260  745.481900  928.847170
r2                        0.955107    0.887238    0.793229    0.786565    0.842986    0.906356
residual_deviance       224.366680  899.694600  611.253970  836.877260  745.481900  928.847170
rmse                     14.978874   29.994910   24.723550   28.928831   27.303514   30.476994
rmsle                     0.153800    0.193915    0.188174    0.263375    0.215363    0.233284
                       cv_24_valid cv_25_valid cv_26_valid cv_27_valid cv_28_valid cv_29_valid
mae                      16.812807   12.769220    9.380861   11.508623   16.744162   28.795687
mean_residual_deviance  525.217800  327.217200  176.260270  221.407610  448.787080 1176.251000
mse                     525.217800  327.217200  176.260270  221.407610  448.787080 1176.251000
r2                        0.898921    0.960732    0.961255    0.961903    0.931780    0.690715
residual_deviance       525.217800  327.217200  176.260270  221.407610  448.787080 1176.251000
rmse                     22.917630   18.089146   13.276305   14.879772   21.184595   34.296516
rmsle                     0.179257    0.177933    0.119703    0.157504    0.211321    0.330476
                       cv_30_valid cv_31_valid cv_32_valid cv_33_valid cv_34_valid cv_35_valid
mae                      19.191156   16.347065   32.393833   12.391585   12.857935   14.353794
mean_residual_deviance  666.293300  598.279100 1732.666900  282.256130  377.688540  711.670800
mse                     666.293300  598.279100 1732.666900  282.256130  377.688540  711.670800
r2                        0.908980    0.921347    0.497159    0.952385    0.932116    0.854270
residual_deviance       666.293300  598.279100 1732.666900  282.256130  377.688540  711.670800
rmse                     25.812658   24.459745   41.625317   16.800480   19.434212   26.677158
rmsle                     0.188510    0.143837    0.360285    0.143225    0.155450    0.193289
                       cv_36_valid cv_37_valid cv_38_valid
mae                      15.538424   17.603981   13.098192
mean_residual_deviance  381.545800  681.006840  349.039370
mse                     381.545800  681.006840  349.039370
r2                        0.945356    0.919019    0.941680
residual_deviance       381.545800  681.006840  349.039370
rmse                     19.533197   26.096107   18.682596
rmsle                     0.189324    0.151758    0.160445
```


## model_dl_temp

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  DeepLearning_model_R_1647001632925_14 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 20,001 weights/biases, 244.9 KB, 66,924 training samples, mini-batch size 1
  layer units      type dropout       l1       l2 mean_rate rate_rms momentum mean_weight weight_rms
1     1   245     Input 10.00 %       NA       NA        NA       NA       NA          NA         NA
2     2    50 Rectifier  0.00 % 0.000000 0.000010  0.026922 0.105205 0.000000    0.000581   0.097625
3     3    50 Rectifier  0.00 % 0.000000 0.000010  0.025921 0.024263 0.000000   -0.036381   0.183900
4     4    50 Rectifier  0.00 % 0.000000 0.000010  0.047346 0.058703 0.000000   -0.036407   0.162007
5     5    50 Rectifier  0.00 % 0.000000 0.000010  0.138975 0.198553 0.000000   -0.035929   0.146549
6     6     1    Linear      NA 0.000000 0.000010  0.004128 0.003310 0.000000    0.027120   0.106565
  mean_bias bias_rms
1        NA       NA
2  0.289441 0.187803
3  0.895886 0.094339
4  0.931858 0.056169
5  0.839440 0.144239
6  0.260065 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  620.1802
RMSE:  24.90342
MAE:  17.15232
RMSLE:  0.1990291
Mean Residual Deviance :  620.1802



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 12-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  2590.217
RMSE:  50.89417
MAE:  34.5352
RMSLE:  0.3772235
Mean Residual Deviance :  2590.217


Cross-Validation Metrics Summary: 
                              mean          sd  cv_1_valid  cv_2_valid cv_3_valid cv_4_valid
mae                      30.881390   19.817810   75.190704   41.722330  20.857393  19.149855
mean_residual_deviance 2150.764000 2773.586400 9142.238000 2668.018000 814.463560 601.594240
mse                    2150.764000 2773.586400 9142.238000 2668.018000 814.463560 601.594240
r2                       -0.205693    1.073358   -0.006064   -0.105843  -0.054458   0.306143
residual_deviance      2150.764000 2773.586400 9142.238000 2668.018000 814.463560 601.594240
rmse                     39.359790   25.617552   95.615060   51.652863  28.538807  24.527418
rmsle                     0.381663    0.083038    0.448866    0.431244   0.333887   0.304883
                        cv_5_valid cv_6_valid cv_7_valid cv_8_valid cv_9_valid cv_10_valid
mae                      28.995089  14.737443  15.342937  11.519558  17.547703   26.454939
mean_residual_deviance 1388.654800 376.352940 453.514340 163.534790 351.948150 1100.285000
mse                    1388.654800 376.352940 453.514340 163.534790 351.948150 1100.285000
r2                        0.193274   0.133728  -0.088631  -0.887926  -3.382809    0.687258
residual_deviance      1388.654800 376.352940 453.514340 163.534790 351.948150 1100.285000
rmse                     37.264660  19.399818  21.295876  12.788073  18.760280   33.170544
rmsle                     0.425378   0.289593   0.339489   0.492281   0.417854    0.330932
                       cv_11_valid cv_12_valid
mae                      60.203346   38.855390
mean_residual_deviance 6177.100600 2571.461400
mse                    6177.100600 2571.461400
r2                        0.238026    0.498985
residual_deviance      6177.100600 2571.461400
rmse                     78.594536   50.709580
rmsle                     0.510065    0.255478
```


