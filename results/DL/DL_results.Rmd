---
title: "DL"
author: "Adithi R Upadhya"
date: "03/12/2021"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## dl_grid

```{r eval = FALSE}
H2O Grid Details
================

Grid ID: dl_grid 
Used hyper parameters: 
  -  activation 
  -  distribution 
  -  epochs 
  -  epsilon 
  -  hidden 
  -  input_dropout_ratio 
  -  l1 
  -  l2 
  -  max_w2 
  -  momentum_stable 
  -  momentum_start 
  -  rate 
  -  rate_annealing 
  -  rho 
Number of models: 36 
Number of failed models: 0 

Hyper-Parameter Search Summary: ordered by increasing residual_deviance
       activation distribution    epochs epsilon           hidden input_dropout_ratio
1            Tanh        gamma 504.88408 0.00000  [5, 5, 5, 5, 5]             0.20000
2            Tanh        gamma 107.10663 0.00000  [5, 5, 5, 5, 5]             0.10000
3            Tanh        gamma 107.10663 0.00000  [5, 5, 5, 5, 5]             0.00000
4 TanhWithDropout        gamma 305.12789 0.00000 [50, 50, 50, 50]             0.10000
5 TanhWithDropout        gamma 305.12789 0.00000 [30, 30, 30, 30]             0.10000
       l1      l2   max_w2 momentum_stable momentum_start    rate rate_annealing     rho
1 0.00010 0.00010 10.00000         0.00000        0.00000 0.00500        0.00000 0.90000
2 0.00000 0.00001  1.00000         0.50000        0.50000 0.00000        0.00000 0.90000
3 0.00010 0.00001  1.00000         0.00000        0.00000 0.00100        0.00000 0.99900
4 0.00000 0.00001 10.00000         0.50000        0.50000 0.00500        0.00000 0.95000
5 0.00010 0.00010 10.00000         0.50000        0.00000 0.00100        0.00000 0.90000
         model_ids residual_deviance
1 dl_grid_model_19          11.22800
2 dl_grid_model_20          11.23727
3 dl_grid_model_21          11.27036
4 dl_grid_model_18          11.36024
5 dl_grid_model_27          11.36783

---
        activation distribution    epochs epsilon               hidden
31 TanhWithDropout     gaussian 305.12789 0.00010      [5, 5, 5, 5, 5]
32            Tanh     gaussian 404.11995 0.00010      [5, 5, 5, 5, 5]
33 TanhWithDropout     gaussian  53.58027 0.00010     [30, 30, 30, 30]
34            Tanh     gaussian 334.92596 0.00010 [100, 100, 100, 100]
35            Tanh     gaussian   9.01936 0.00010 [100, 100, 100, 100]
36 TanhWithDropout     gaussian 115.36108 0.00010     [50, 50, 50, 50]
   input_dropout_ratio      l1      l2    max_w2 momentum_stable momentum_start    rate
31             0.20000 0.00001 0.00010  10.00000         0.50000        0.00000 0.00000
32             0.00000 0.00000 0.00001  10.00000         0.00000        0.00000 0.00000
33             0.00000 0.00000 0.00000 100.00000         0.50000        0.50000 0.00000
34             0.10000 0.00010 0.00001 100.00000         0.99000        0.00000 0.00500
35             0.10000 0.00000 0.00010  10.00000         0.99000        0.00000 0.00500
36             0.10000 0.00010 0.00000  10.00000         0.00000        0.00000 0.00000
   rate_annealing     rho        model_ids residual_deviance
31        0.00000 0.95000 dl_grid_model_15        5876.30480
32        0.00000 0.99900  dl_grid_model_3        6451.85305
33        0.00000 0.99000  dl_grid_model_9        7279.99408
34        0.00000 0.95000 dl_grid_model_23       27452.74039
35        0.00000 0.95000 dl_grid_model_36       28526.29936
36        0.00000 0.99900 dl_grid_model_34      141894.41153
```

## print(grid_perf)

```{r eval = FALSE}
 H2O Grid Details
================

Grid ID: dl_grid 
Used hyper parameters: 
  -  activation 
  -  distribution 
  -  epochs 
  -  epsilon 
  -  hidden 
  -  input_dropout_ratio 
  -  l1 
  -  l2 
  -  max_w2 
  -  momentum_stable 
  -  momentum_start 
  -  rate 
  -  rate_annealing 
  -  rho 
Number of models: 36 
Number of failed models: 0 

Hyper-Parameter Search Summary: ordered by increasing mse
  activation distribution    epochs epsilon           hidden input_dropout_ratio      l1
1       Tanh     gaussian  53.58027 0.00000 [30, 30, 30, 30]             0.10000 0.00001
2       Tanh        gamma 504.88408 0.00000  [5, 5, 5, 5, 5]             0.20000 0.00010
3       Tanh     gaussian 206.11739 0.00000 [30, 30, 30, 30]             0.20000 0.00000
4       Tanh        gamma 107.10663 0.00000  [5, 5, 5, 5, 5]             0.10000 0.00000
5       Tanh        gamma 107.10663 0.00000  [5, 5, 5, 5, 5]             0.00000 0.00010
       l2   max_w2 momentum_stable momentum_start    rate rate_annealing     rho
1 0.00001 10.00000         0.50000        0.00000 0.00000        0.00000 0.95000
2 0.00010 10.00000         0.00000        0.00000 0.00500        0.00000 0.90000
3 0.00001 10.00000         0.00000        0.00000 0.00000        0.00000 0.90000
4 0.00001  1.00000         0.50000        0.50000 0.00000        0.00000 0.90000
5 0.00001  1.00000         0.00000        0.00000 0.00100        0.00000 0.99900
         model_ids        mse
1 dl_grid_model_33  594.17190
2 dl_grid_model_19  594.50137
3  dl_grid_model_8  679.51484
4 dl_grid_model_20  806.85636
5 dl_grid_model_21 1271.34327

---
        activation distribution    epochs epsilon               hidden
31            Tanh        gamma  18.05508 0.00010     [50, 50, 50, 50]
32            Tanh        gamma  53.58027 0.00010     [50, 50, 50, 50]
33 TanhWithDropout     gaussian  53.58027 0.00010     [30, 30, 30, 30]
34            Tanh     gaussian 334.92596 0.00010 [100, 100, 100, 100]
35            Tanh     gaussian   9.01936 0.00010 [100, 100, 100, 100]
36 TanhWithDropout     gaussian 115.36108 0.00010     [50, 50, 50, 50]
   input_dropout_ratio      l1      l2    max_w2 momentum_stable momentum_start    rate
31             0.20000 0.00000 0.00010 100.00000         0.50000        0.50000 0.00100
32             0.10000 0.00000 0.00010   1.00000         0.00000        0.50000 0.00500
33             0.00000 0.00000 0.00000 100.00000         0.50000        0.50000 0.00000
34             0.10000 0.00010 0.00001 100.00000         0.99000        0.00000 0.00500
35             0.10000 0.00000 0.00010  10.00000         0.99000        0.00000 0.00500
36             0.10000 0.00010 0.00000  10.00000         0.00000        0.00000 0.00000
   rate_annealing     rho        model_ids          mse
31        0.00000 0.90000 dl_grid_model_35   6850.94241
32        0.00000 0.90000 dl_grid_model_12   7090.52907
33        0.00000 0.99000  dl_grid_model_9   7279.99408
34        0.00000 0.95000 dl_grid_model_23  27452.74039
35        0.00000 0.95000 dl_grid_model_36  28526.29936
36        0.00000 0.99900 dl_grid_model_34 141894.41153
```


## best_model

```{r eval = FALSE}
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.0 KB, 210,131 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039488 0.189886 0.000000    0.000766
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.008613 0.004960 0.000000    0.001928
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.014741 0.008787 0.000000   -0.010104
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.065293 0.152064 0.000000    0.001205
6     6     1 Linear      NA 0.000010 0.000010  0.009091 0.030009 0.000000   -0.006495
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.091729 -0.025906 0.134391
3   0.214471  0.008939 0.129609
4   0.210920  0.020704 0.209174
5   0.198611 -0.012761 0.237543
6   0.198861  0.230234 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  317.5492
RMSE:  17.81991
MAE:  11.8482
RMSLE:  0.1500814
Mean Residual Deviance :  317.5492



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 10-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  594.1719
RMSE:  24.37564
MAE:  16.78922
RMSLE:  0.19955
Mean Residual Deviance :  594.1719


Cross-Validation Metrics Summary: 
                             mean         sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid
mae                     16.723730   2.326353  17.758130  22.429516  16.044300  16.775139
mean_residual_deviance 591.066800 162.271470 721.286200 936.492860 560.542660 598.859300
mse                    591.066800 162.271470 721.286200 936.492860 560.542660 598.859300
r2                       0.897832   0.030631   0.855498   0.841156   0.896450   0.904107
residual_deviance      591.066800 162.271470 721.286200 936.492860 560.542660 598.859300
rmse                    24.113256   3.268979  26.856771  30.602170  23.675781  24.471601
rmsle                    0.198160   0.020666   0.206698   0.244544   0.189156   0.183289
                       cv_5_valid cv_6_valid cv_7_valid cv_8_valid cv_9_valid
mae                     13.392821  16.580969  16.527500  15.407349  15.420336
mean_residual_deviance 378.653350 583.508700 636.870200 429.299530 434.001680
mse                    378.653350 583.508700 636.870200 429.299530 434.001680
r2                       0.940813   0.911432   0.893849   0.924257   0.921786
residual_deviance      378.653350 583.508700 636.870200 429.299530 434.001680
rmse                    19.459017  24.155926  25.236288  20.719545  20.832706
rmsle                    0.169571   0.186755   0.216400   0.197273   0.193241
                       cv_10_valid
mae                      16.901245
mean_residual_deviance  631.153300
mse                     631.153300
r2                        0.888972
residual_deviance       631.153300
rmse                     25.122765
rmsle                     0.194673
```


## h2o.varimp(best_model)

```{r eval = FALSE}
Variable Importances: 
  variable relative_importance scaled_importance percentage
1   day.81            1.000000          1.000000   0.005972
2  day.333            0.917059          0.917059   0.005477
3  day.261            0.904480          0.904480   0.005402
4  day.171            0.867628          0.867628   0.005182
5  day.108            0.866431          0.866431   0.005175

---
                    variable relative_importance scaled_importance percentage
277          Station_code.36            0.412797          0.412797   0.002465
278                   day.63            0.408197          0.408197   0.002438
279                       RH            0.354373          0.354373   0.002116
280          day.missing(NA)            0.000000          0.000000   0.000000
281 Station_code.missing(NA)            0.000000          0.000000   0.000000
282       season.missing(NA)            0.000000          0.000000   0.000000
```

## cv_models

```{r eval = FALSE}
[[1]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_1 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 193,124 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.043096 0.196443 0.000000    0.000341
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.007072 0.004857 0.000000    0.001237
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.010796 0.006855 0.000000   -0.006472
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.064348 0.205634 0.000000    0.002297
6     6     1 Linear      NA 0.000010 0.000010  0.006299 0.022764 0.000000   -0.013890
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.088332 -0.017628 0.120409
3   0.204556 -0.021035 0.119805
4   0.208534  0.005239 0.187673
5   0.197633 -0.004025 0.212131
6   0.209560  0.231127 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  583.9293
RMSE:  24.16463
MAE:  16.49679
RMSLE:  0.1890711
Mean Residual Deviance :  583.9293


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  721.2862
RMSE:  26.85677
MAE:  17.75813
RMSLE:  0.206698
Mean Residual Deviance :  721.2862




[[2]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_2 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 186,019 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.046378 0.202982 0.000000    0.000679
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.006608 0.004887 0.000000    0.001935
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.009313 0.006842 0.000000   -0.009486
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.082083 0.197019 0.000000    0.002468
6     6     1 Linear      NA 0.000010 0.000010  0.009562 0.030290 0.000000   -0.007895
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.086933 -0.028090 0.111233
3   0.202720 -0.019976 0.130737
4   0.205428 -0.005900 0.166936
5   0.190960 -0.006896 0.168207
6   0.204753  0.173349 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  683.2121
RMSE:  26.13833
MAE:  18.51886
RMSLE:  0.2089108
Mean Residual Deviance :  683.2121


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  936.4928
RMSE:  30.60217
MAE:  22.42952
RMSLE:  0.2445436
Mean Residual Deviance :  936.4928




[[3]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_3 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 188,692 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039478 0.189871 0.000000    0.001103
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.006641 0.005716 0.000000    0.001021
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.008705 0.006071 0.000000   -0.006511
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.138961 0.298784 0.000000    0.001307
6     6     1 Linear      NA 0.000010 0.000010  0.019339 0.053774 0.000000   -0.008294
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.090489 -0.015757 0.131463
3   0.212214 -0.013424 0.130120
4   0.210220  0.001095 0.171565
5   0.192176 -0.011259 0.225271
6   0.201356  0.299950 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  418.8731
RMSE:  20.46639
MAE:  14.25309
RMSLE:  0.1743865
Mean Residual Deviance :  418.8731


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  560.5426
RMSE:  23.67578
MAE:  16.0443
RMSLE:  0.1891563
Mean Residual Deviance :  560.5426




[[4]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_4 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 189,575 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.050399 0.209389 0.000000    0.001323
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.009436 0.007134 0.000000   -0.000169
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.013172 0.009190 0.000000   -0.003737
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.104774 0.231767 0.000000    0.001560
6     6     1 Linear      NA 0.000010 0.000010  0.003677 0.010308 0.000000   -0.012584
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.090837 -0.018232 0.123070
3   0.211593 -0.030241 0.125496
4   0.212511 -0.003778 0.195921
5   0.192377 -0.012045 0.226077
6   0.203405  0.265898 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  409.0212
RMSE:  20.22427
MAE:  14.39915
RMSLE:  0.1780011
Mean Residual Deviance :  409.0212


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  598.8593
RMSE:  24.4716
MAE:  16.77514
RMSLE:  0.1832892
Mean Residual Deviance :  598.8593




[[5]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_5 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 192,601 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039360 0.189885 0.000000    0.000667
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.008344 0.005970 0.000000    0.000047
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.013181 0.007355 0.000000   -0.006858
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.116021 0.287929 0.000000    0.002419
6     6     1 Linear      NA 0.000010 0.000010  0.034177 0.106067 0.000000   -0.018651
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.089913  0.003769 0.123643
3   0.212344 -0.025118 0.101052
4   0.209140  0.004964 0.204489
5   0.196176 -0.041857 0.227960
6   0.204184  0.275173 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  436.9978
RMSE:  20.90449
MAE:  14.235
RMSLE:  0.1711815
Mean Residual Deviance :  436.9978


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  378.6534
RMSE:  19.45902
MAE:  13.39282
RMSLE:  0.1695711
Mean Residual Deviance :  378.6534




[[6]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_6 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 187,151 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039200 0.189913 0.000000    0.000176
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.007507 0.005991 0.000000    0.001395
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.012517 0.007721 0.000000   -0.004391
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.098053 0.233298 0.000000   -0.000054
6     6     1 Linear      NA 0.000010 0.000010  0.007064 0.023854 0.000000   -0.009421
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.090596 -0.023847 0.141045
3   0.210954 -0.000371 0.128252
4   0.208164 -0.001784 0.195047
5   0.195079 -0.021941 0.234271
6   0.201739  0.300433 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  437.5793
RMSE:  20.9184
MAE:  14.51103
RMSLE:  0.1764458
Mean Residual Deviance :  437.5793


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  583.5088
RMSE:  24.15593
MAE:  16.58097
RMSLE:  0.1867551
Mean Residual Deviance :  583.5088




[[7]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_7 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 192,070 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.046747 0.202931 0.000000    0.001534
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.012275 0.008862 0.000000   -0.000412
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.017403 0.013108 0.000000   -0.001037
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.138305 0.315262 0.000000    0.001171
6     6     1 Linear      NA 0.000010 0.000010  0.029266 0.106748 0.000000   -0.003872
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.090483 -0.008896 0.120795
3   0.210584 -0.029270 0.123707
4   0.209491  0.003396 0.202505
5   0.190677 -0.043870 0.255256
6   0.195279  0.292520 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  389.6294
RMSE:  19.73903
MAE:  13.82595
RMSLE:  0.1647032
Mean Residual Deviance :  389.6294


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  636.8702
RMSE:  25.23629
MAE:  16.5275
RMSLE:  0.2164001
Mean Residual Deviance :  636.8702




[[8]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_8 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 191,916 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039521 0.189876 0.000000    0.000227
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.008803 0.006146 0.000000   -0.001376
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.014108 0.010330 0.000000   -0.005704
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.084914 0.223509 0.000000    0.001418
6     6     1 Linear      NA 0.000010 0.000010  0.026588 0.092715 0.000000   -0.018498
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.089598  0.003801 0.116528
3   0.210980 -0.033567 0.130078
4   0.207100  0.029128 0.189787
5   0.195009 -0.040106 0.227184
6   0.203203  0.261418 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  418.9538
RMSE:  20.46836
MAE:  14.65397
RMSLE:  0.1845077
Mean Residual Deviance :  418.9538


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  429.2995
RMSE:  20.71954
MAE:  15.40735
RMSLE:  0.1972734
Mean Residual Deviance :  429.2995




[[9]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_9 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 188,784 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.042953 0.196457 0.000000    0.001100
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.008381 0.005700 0.000000    0.002130
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.015055 0.010588 0.000000   -0.006001
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.106618 0.280123 0.000000    0.002226
6     6     1 Linear      NA 0.000010 0.000010  0.054895 0.175201 0.000000   -0.003197
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.090199 -0.023252 0.114193
3   0.208190  0.002765 0.113815
4   0.210188  0.006234 0.189279
5   0.195547 -0.025122 0.248559
6   0.206010  0.251738 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  454.18
RMSE:  21.3115
MAE:  15.08839
RMSLE:  0.1794014
Mean Residual Deviance :  454.18


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  434.0017
RMSE:  20.83271
MAE:  15.42034
RMSLE:  0.1932406
Mean Residual Deviance :  434.0017




[[10]]
Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  dl_grid_model_33_cv_10 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.9 KB, 178,373 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.039401 0.189885 0.000000    0.000790
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.007494 0.005881 0.000000   -0.001223
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.011813 0.007286 0.000000   -0.005744
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.080606 0.212990 0.000000    0.002093
6     6     1 Linear      NA 0.000010 0.000010  0.008099 0.028125 0.000000   -0.009100
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.089629 -0.010249 0.098623
3   0.210068  0.000419 0.136339
4   0.209545  0.034522 0.226522
5   0.196569 -0.020611 0.213685
6   0.197163  0.243103 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on temporary training frame with 3916 samples **

MSE:  469.2932
RMSE:  21.66318
MAE:  15.10287
RMSLE:  0.1756946
Mean Residual Deviance :  469.2932


H2ORegressionMetrics: deeplearning
** Reported on validation data. **
** Metrics reported on full validation frame **

MSE:  631.1533
RMSE:  25.12277
MAE:  16.90124
RMSLE:  0.1946735
Mean Residual Deviance :  631.1533``{r eval = FALSE}

```



## h2o.scoreHistory(best_model)


```{r eval = FALSE}
Scoring History: 
            timestamp     duration training_speed   epochs iterations       samples
1 2021-12-17 20:53:56    0.000 sec             NA  0.00000          0      0.000000
2 2021-12-17 20:53:56  1:27:08.779  51751 obs/sec  5.37870          1  21063.000000
3 2021-12-17 20:53:59  1:27:12.324  53373 obs/sec 53.65960         10 210131.000000
  training_rmse training_deviance training_mae training_r2
1            NA                NA           NA          NA
2      28.44509         809.12335     19.69486     0.86189
3      17.81991         317.54923     11.84820     0.94580
```

## best_model_perf


```{r eval = FALSE}
H2ORegressionMetrics: deeplearning

MSE:  428.8604
RMSE:  20.70895
MAE:  13.86179
RMSLE:  0.1670781
Mean Residual Deviance :  428.8604
```

## h2o.mse(best_model_perf) %>% sqrt()

```{r eval = FALSE}
20.70895
```


## model_dl

```{r eval = FALSE}
 Model Details:
==============

H2ORegressionModel: deeplearning
Model ID:  DeepLearning_model_R_1639749302821_1 
Status of Neuron Layers: predicting PM2.5, regression, gaussian distribution, Quadratic loss, 11,311 weights/biases, 142.4 KB, 111,540 training samples, mini-batch size 1
  layer units   type dropout       l1       l2 mean_rate rate_rms momentum mean_weight
1     1   282  Input 10.00 %       NA       NA        NA       NA       NA          NA
2     2    30   Tanh  0.00 % 0.000010 0.000010  0.027301 0.104469 0.000000    0.000152
3     3    30   Tanh  0.00 % 0.000010 0.000010  0.046442 0.029375 0.000000    0.004252
4     4    30   Tanh  0.00 % 0.000010 0.000010  0.052423 0.033213 0.000000   -0.006030
5     5    30   Tanh  0.00 % 0.000010 0.000010  0.193622 0.204716 0.000000   -0.001468
6     6     1 Linear      NA 0.000010 0.000010  0.012552 0.014213 0.000000    0.002932
  weight_rms mean_bias bias_rms
1         NA        NA       NA
2   0.101553  0.003295 0.180648
3   0.255426  0.017951 0.164484
4   0.219522  0.073901 0.271642
5   0.184941 -0.052402 0.255533
6   0.151049  0.651890 0.000000


H2ORegressionMetrics: deeplearning
** Reported on training data. **
** Metrics reported on full training frame **

MSE:  370.5959
RMSE:  19.25087
MAE:  13.37479
RMSLE:  0.1636528
Mean Residual Deviance :  370.5959



H2ORegressionMetrics: deeplearning
** Reported on cross-validation data. **
** 10-fold cross-validation on training data (Metrics computed for combined holdout predictions) **

MSE:  465.0682
RMSE:  21.56544
MAE:  14.84452
RMSLE:  0.1806941
Mean Residual Deviance :  465.0682


Cross-Validation Metrics Summary: 
                             mean        sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid
mae                     14.847466  0.825079  14.670414  14.679204  16.202507  15.215538
mean_residual_deviance 465.729280 50.755306 465.001560 408.312100 565.678340 486.284850
mse                    465.729280 50.755306 465.001560 408.312100 565.678340 486.284850
r2                       0.921544  0.010264   0.921182   0.939182   0.907343   0.922632
residual_deviance      465.729280 50.755306 465.001560 408.312100 565.678340 486.284850
rmse                    21.552626  1.161231  21.563894  20.206734  23.783993  22.051867
rmsle                    0.180225  0.012572   0.183288   0.180911   0.190426   0.177421
                       cv_5_valid cv_6_valid cv_7_valid cv_8_valid cv_9_valid
mae                     14.076158  13.591070  16.017100  15.230082  14.380145
mean_residual_deviance 505.224850 411.651860 443.305730 508.974850 419.917270
mse                    505.224850 411.651860 443.305730 508.974850 419.917270
r2                       0.909053   0.926979   0.922758   0.909932   0.924741
residual_deviance      505.224850 411.651860 443.305730 508.974850 419.917270
rmse                    22.477207  20.289206  21.054827  22.560470  20.491882
rmsle                    0.181255   0.176517   0.207604   0.170717   0.174096
                       cv_10_valid
mae                      14.412445
mean_residual_deviance  442.941250
mse                     442.941250
r2                        0.931638
residual_deviance       442.941250
rmse                     21.046170
rmsle                     0.160016
```

## h2o.varimp(model_dl)

`Variable Importances: 
  variable relative_importance scaled_importance percentage
1   day.81            1.000000          1.000000   0.007227
2  day.261            0.928273          0.928273   0.006709
3  day.316            0.886567          0.886567   0.006408
4  day.319            0.861655          0.861655   0.006227
5  day.333            0.847667          0.847667   0.006126

---
                    variable relative_importance scaled_importance percentage
277                   day.63            0.325322          0.325322   0.002351
278                  day.116            0.323131          0.323131   0.002335
279                       WS            0.301644          0.301644   0.002180
280          day.missing(NA)            0.000000          0.000000   0.000000
281 Station_code.missing(NA)            0.000000          0.000000   0.000000
282       season.missing(NA)            0.000000          0.000000   0.000000``{r eval = FALSE}

```




